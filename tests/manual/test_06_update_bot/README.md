# Тест 06: Update бота

## Статус: ✅ ПРОЙДЕН

**Дата:** 2026-01-19

## Описание
Проверка возможности обновления кода работающего бота без полной остановки/запуска вручную.

## Шаги
1. Запустить бота версии 1 (`echo_bot.py` с `TEST_NUMBER=V1`)
2. Проверить что бот запущен
3. Обновить бота на версию 2 (`echo_bot_v2.py` с `BOT_VERSION=V2`)
4. Проверить статус после обновления
5. Проверить логи (должна быть версия V2)

## Ожидаемый результат
- Бот V1 запускается успешно
- Команда `update` останавливает старого бота и запускает нового
- Логи показывают новую версию

## Логи и результаты
```
# Шаг 1: Запускаем бота V1
🚀 Запуск бота 'update-test-bot'...
Job ID: fd03f32d-c037-4217-981f-85b5e0afe874
╭────────────────────────────────── ✅ Успех ──────────────────────────────────╮
│ Бот 'update-test-bot' успешно запущен!                                       │
╰──────────────────────────────────────────────────────────────────────────────╯

# Шаг 2: Проверяем статус (V1)
📊 Статус бота 'update-test-bot'
╭──────────────────────────── Бот: update-test-bot ────────────────────────────╮
│ 🟢 RUNNING                                                                   │
│ • Container: bot_cli_26ace80c6eac526b_update-test-bot                        │
│ • Started: 2026-01-19T17:35:08.123724                                        │
╰──────────────────────────────────────────────────────────────────────────────╯

# Шаг 3: Обновляем на V2
🔄 Обновление бота 'update-test-bot'...
Шаг 1/2: Остановка текущего бота...
Job ID: 7a532d9f-ff55-4d8b-b5e5-cc5efa96a04b
   ✓ Остановлен
Шаг 2/2: Запуск с новым кодом...
Job ID: b16596dc-b013-46e3-9153-7989749c5098
╭────────────────────────────────── ✅ Успех ──────────────────────────────────╮
│ Бот 'update-test-bot' успешно обновлён!                                      │
╰──────────────────────────────────────────────────────────────────────────────╯

# Шаг 4: Статус после обновления
📊 Статус бота 'update-test-bot'
╭──────────────────────────── Бот: update-test-bot ────────────────────────────╮
│ 🟢 RUNNING                                                                   │
│ • Container: bot_cli_26ace80c6eac526b_update-test-bot                        │
│ • Started: 2026-01-19T17:35:44.225340  ← Новое время запуска                 │
╰──────────────────────────────────────────────────────────────────────────────╯

# Шаг 5: Логи (V2)
2026-01-19T17:35:45.661371175Z 2026-01-19 17:35:45,661 - __main__ - INFO - 
Starting Echo Bot V2...  ← Версия обновилась!
2026-01-19T17:35:45.854222717Z 2026-01-19 17:35:45,853 - __main__ - INFO - Bot: @testTimax_bot
2026-01-19T17:35:45.854800426Z 2026-01-19 17:35:45,854 - aiogram.dispatcher - INFO - Start polling
```

## Что проверялось
- ✅ Команда `update` работает
- ✅ Старый контейнер останавливается
- ✅ Новый контейнер запускается с обновлённым кодом
- ✅ Логи отражают новую версию бота
- ✅ Статус показывает новое время запуска

## Выводы
- Update бота работает корректно через механизм stop + start
- CLI обрабатывает все шаги автоматически
- Пользователь получает понятные сообщения о прогрессе
